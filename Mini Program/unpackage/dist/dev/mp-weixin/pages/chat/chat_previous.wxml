<view class="chat-container data-v-1eab3380"><scroll-view class="chat-messages data-v-1eab3380" scroll-y="true" scroll-with-animation="true" scroll-top="{{scrollTop}}" enhanced="{{true}}" show-scrollbar="{{false}}"><block wx:for="{{$root.l1}}" wx:for-item="msg" wx:for-index="index" wx:key="index"><view class="message-item data-v-1eab3380" id="{{'msg-'+index}}"><view class="{{['message','data-v-1eab3380',msg.$orig.role+'-message',msg.$orig.type==='audio'?'audio-message':'',msg.$orig.type==='image'?'image-message':'']}}"><block wx:if="{{msg.$orig.role==='dog'}}"><image class="avatar data-v-1eab3380" src="/static/dog_avatar.png"></image></block><view class="message-content data-v-1eab3380"><block wx:if="{{msg.$orig.role==='dog'&&msg.$orig.thinking}}"><view class="thinking-section data-v-1eab3380"><view class="thinking-header data-v-1eab3380"><uni-icons vue-id="{{'24a2e2c6-1-'+index}}" type="compose" size="16" color="#888" class="data-v-1eab3380" bind:__l="__l"></uni-icons><text class="thinking-title data-v-1eab3380">æ€è€ƒä¸­</text><block wx:if="{{msg.$orig.isThinking}}"><view class="thinking-indicator data-v-1eab3380"><view class="dot data-v-1eab3380"></view><view class="dot data-v-1eab3380"></view><view class="dot data-v-1eab3380"></view></view></block></view><view class="thinking-content data-v-1eab3380">{{''+msg.$orig.thinking+''}}</view></view></block><block wx:if="{{msg.$orig.type==='text'||!msg.$orig.type}}"><block wx:if="{{msg.$orig.role==='dog'}}"><view class="answer-section data-v-1eab3380">{{''+msg.$orig.content+''}}<block wx:if="{{msg.$orig.isStreaming}}"><view class="streaming-indicator data-v-1eab3380"><view class="dot data-v-1eab3380"></view><view class="dot data-v-1eab3380"></view><view class="dot data-v-1eab3380"></view></view></block></view></block><block wx:else><view class="data-v-1eab3380">{{''+msg.$orig.content+''}}<block wx:if="{{msg.$orig.isStreaming}}"><view class="streaming-indicator data-v-1eab3380"><view class="dot data-v-1eab3380"></view><view class="dot data-v-1eab3380"></view><view class="dot data-v-1eab3380"></view></view></block></view></block></block><block wx:else><block wx:if="{{msg.$orig.type==='audio'}}"><view class="audio-content data-v-1eab3380"><block wx:if="{{msg.$orig.isUploading}}"><view class="audio-uploading data-v-1eab3380"><view class="uploading-icon data-v-1eab3380"><uni-icons vue-id="{{'24a2e2c6-2-'+index}}" type="spinner-cycle" size="16" color="#1a73e8" class="data-v-1eab3380" bind:__l="__l"></uni-icons></view><text class="uploading-text data-v-1eab3380">æ­£åœ¨ä¸Šä¼ ...</text></view></block><block wx:else><block wx:if="{{msg.$orig.uploadFailed}}"><view data-event-opts="{{[['tap',[['retryAudioUpload',['$0','$1'],[[['messages','',index,'filePath']],[['messages','',index,'duration']]]]]]]}}" class="audio-failed data-v-1eab3380" bindtap="__e"><view class="failed-icon data-v-1eab3380"><uni-icons vue-id="{{'24a2e2c6-3-'+index}}" type="closeempty" size="16" color="#ff3b30" class="data-v-1eab3380" bind:__l="__l"></uni-icons></view><text class="failed-text data-v-1eab3380">{{msg.$orig.content}}</text></view></block><block wx:else><view data-event-opts="{{[['tap',[['toggleAudioPlayback',['$0',index],[[['messages','',index]]]]]]]}}" class="audio-player-container data-v-1eab3380" bindtap="__e"><text class="audio-text data-v-1eab3380">{{msg.$orig.content||'[è¯­éŸ³æ¶ˆæ¯]'}}</text><view class="audio-player data-v-1eab3380"><view class="play-button data-v-1eab3380"><uni-icons vue-id="{{'24a2e2c6-4-'+index}}" type="{{msg.$orig.isPlaying?'pause-filled':'play-filled'}}" size="20" color="{{msg.$orig.isPlaying?'#ff3b30':'#1a73e8'}}" class="data-v-1eab3380" bind:__l="__l"></uni-icons></view><view class="wave-container data-v-1eab3380"><block wx:for="{{msg.l0}}" wx:for-item="bar" wx:for-index="idx" wx:key="idx"><view class="wave-bar data-v-1eab3380" style="{{'height:'+(msg.$orig.isPlaying?bar.m0+'px':'8px')+';'}}"></view></block></view><text class="time-display data-v-1eab3380">{{''+msg.m1+" / "+msg.m2+''}}</text></view><view class="progress-container data-v-1eab3380"><view class="progress-bar data-v-1eab3380" style="{{'width:'+(msg.$orig.progress+'%')+';'}}"></view></view></view></block></block><block wx:if="{{msg.$orig.transcriptText}}"><view class="transcript-container data-v-1eab3380"><view data-event-opts="{{[['tap',[['toggleTranscript',['$0',index],[[['messages','',index]]]]]]]}}" class="transcript-toggle data-v-1eab3380" bindtap="__e"><text class="toggle-text data-v-1eab3380">{{(msg.$orig.showTranscript?'æ”¶èµ·':'å±•å¼€')+"è½¬å½•æ–‡æœ¬"}}</text><uni-icons vue-id="{{'24a2e2c6-5-'+index}}" type="{{msg.$orig.showTranscript?'up':'down'}}" size="16" color="#666" class="data-v-1eab3380" bind:__l="__l"></uni-icons></view><block wx:if="{{msg.$orig.showTranscript}}"><view class="transcript-content data-v-1eab3380"><text class="transcript-text data-v-1eab3380">{{msg.$orig.transcriptText}}</text></view></block></view></block><block wx:if="{{msg.$orig.transcribing}}"><view class="transcript-status data-v-1eab3380"><text class="status-text data-v-1eab3380">æ­£åœ¨è¯†åˆ«è¯­éŸ³å†…å®¹...</text></view></block></view></block><block wx:else><block wx:if="{{msg.$orig.type==='image'}}"><block wx:if="{{msg.$orig.role==='dog'}}"><view class="answer-section data-v-1eab3380"><view class="image-content data-v-1eab3380"><text class="image-text data-v-1eab3380" style="padding:20px;">{{msg.$orig.content}}</text><block wx:if="{{msg.$orig.isStreaming}}"><view class="streaming-indicator data-v-1eab3380"><view class="dot data-v-1eab3380"></view><view class="dot data-v-1eab3380"></view><view class="dot data-v-1eab3380"></view></view></block><view class="image-container data-v-1eab3380" style="{{'position:'+('relative')+';'+('width:'+('100%')+';')}}"><image class="chat-image blur-image data-v-1eab3380" style="{{'position:'+('absolute')+';'+('top:'+(0)+';')+('left:'+(0)+';')+('width:'+('100%')+';')+('height:'+('100%')+';')+('filter:'+('blur(10px)')+';')+('opacity:'+(msg.$orig.imageLoaded?0:1)+';')+('transition:'+('opacity 5s ease')+';')}}" src="{{msg.m3}}" mode="widthFix"></image><image class="chat-image data-v-1eab3380" style="{{'position:'+('relative')+';'+('opacity:'+(msg.$orig.imageLoaded?1:0)+';')+('transition:'+('opacity 10s ease')+';')}}" src="{{msg.m4}}" mode="widthFix" data-event-opts="{{[['load',[['handleImageLoad',['$0',index],[[['messages','',index]]]]]],['tap',[['previewImage',[msg.m5]]]],['error',[['onImageError',['$event']]]]]}}" bindload="__e" bindtap="__e" binderror="__e"></image></view></view></view></block></block></block></block></view><block wx:if="{{msg.$orig.role==='user'}}"><image class="avatar data-v-1eab3380" src="/static/user_avatar.png"></image></block></view></view></block><view class="bottom-space data-v-1eab3380"></view></scroll-view><view class="{{['bottom-section','data-v-1eab3380',(isKeyboardShow)?'keyboard-show':'']}}"><view class="model-selector data-v-1eab3380"><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="{{['model-item','data-v-1eab3380',(isLongThinkActive)?'active':'']}}" bindtap="__e"><text class="model-icon data-v-1eab3380">âœ¦</text><text class="model-text data-v-1eab3380">é•¿æ€è€ƒï¼ˆk1.5ï¼‰</text></view><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" class="{{['network-item','data-v-1eab3380',(isWebSearchActive)?'active':'']}}" bindtap="__e"><text class="network-icon data-v-1eab3380">ğŸŒ</text><text class="network-text data-v-1eab3380">è”ç½‘æœç´¢</text></view></view><view class="{{['input-container','data-v-1eab3380',(isVoiceMode)?'voice-mode':'',(isRecording)?'recording':'']}}"><block wx:if="{{isVoiceMode}}"><view class="voice-input-area data-v-1eab3380"><view data-event-opts="{{[['tap',[['toggleInputMode',['$event']]]]]}}" class="voice-btn data-v-1eab3380" bindtap="__e"><image class="voice-icon data-v-1eab3380" src="/static/keyboard.png" mode="aspectFit"></image></view><view data-event-opts="{{[['touchstart',[['startRecording',['$event']]]],['touchend',[['stopRecording',['$event']]]],['touchcancel',[['cancelRecording',['$event']]]]]}}" class="voice-placeholder data-v-1eab3380" bindtouchstart="__e" bindtouchend="__e" bindtouchcancel="__e"><block wx:if="{{!isRecording}}"><text style="font-size:38rpx;" class="data-v-1eab3380">é•¿æŒ‰è¯´è¯</text></block><block wx:else><text style="font-size:38rpx;" class="data-v-1eab3380">æ¾å¼€ç»“æŸ</text></block></view><view data-event-opts="{{[['tap',[['showAddOptions',['$event']]]]]}}" class="add-btn data-v-1eab3380" bindtap="__e"><text class="add-icon data-v-1eab3380">+</text></view></view></block><block wx:else><view class="text-input-area data-v-1eab3380"><view data-event-opts="{{[['tap',[['toggleInputMode',['$event']]]]]}}" class="voice-btn data-v-1eab3380" bindtap="__e"><image class="voice-icon data-v-1eab3380" src="/static/microphone.png" mode="aspectFit"></image></view><input class="message-input data-v-1eab3380" placeholder="æœ‰ä»€ä¹ˆé—®é¢˜å°½ç®¡é—®æˆ‘" data-event-opts="{{[['confirm',[['sendMessage',['$event']]]],['input',[['__set_model',['','textMessage','$event',[]]]]]]}}" value="{{textMessage}}" bindconfirm="__e" bindinput="__e"/><view data-event-opts="{{[['tap',[['showAddOptions',['$event']]]]]}}" class="add-btn data-v-1eab3380" bindtap="__e"><text class="add-icon data-v-1eab3380">+</text></view><block wx:if="{{$root.g0}}"><view data-event-opts="{{[['tap',[['sendMessage',['$event']]]]]}}" class="send-btn data-v-1eab3380" bindtap="__e"><image class="send-icon data-v-1eab3380" src="/static/send.png" mode="aspectFit"></image></view></block></view></block></view></view><block wx:if="{{showAttachmentModal}}"><view data-event-opts="{{[['tap',[['hideAttachmentModal',['$event']]]]]}}" class="attachment-modal data-v-1eab3380" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="attachment-content data-v-1eab3380" catchtap="__e"><view data-event-opts="{{[['tap',[['selectPhoto',['$event']]]]]}}" class="attachment-item data-v-1eab3380" bindtap="__e"><text class="attachment-text data-v-1eab3380">æ‹ç…§</text></view><view data-event-opts="{{[['tap',[['selectAlbum',['$event']]]]]}}" class="attachment-item data-v-1eab3380" bindtap="__e"><text class="attachment-text data-v-1eab3380">æœ¬åœ°ç›¸å†Œ</text></view><view data-event-opts="{{[['tap',[['selectDocument',['$event']]]]]}}" class="attachment-item data-v-1eab3380" bindtap="__e"><text class="attachment-text data-v-1eab3380">å–æ¶ˆ</text></view></view></view></block><block wx:if="{{isRecording}}"><view class="wave-visualization data-v-1eab3380"><block wx:for="{{$root.l2}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="wave-item data-v-1eab3380" style="{{'height:'+(item.$orig+'px')+';'+('background-color:'+(item.m6)+';')}}"></view></block></view></block><block wx:if="{{isRecording}}"><view class="recording-status data-v-1eab3380"><text class="data-v-1eab3380">{{isCancelMode?'æ¾æ‰‹å–æ¶ˆ':'æ‰‹æŒ‡ä¸Šæ»‘ï¼Œå–æ¶ˆå‘é€'}}</text></view></block></view>